---
// src/components/SiteHeader.astro

interface Props {
  logoSrc?: string;
  brand?: string;
  ctaHref?: string;
  ctaText?: string;
}
const {
  logoSrc = "/images/brand/age.avif",
  brand = "Amrita Fashions",
  ctaHref = "#contact",
  ctaText = "Get Quote Now",
} = Astro.props as Props;
---

<a class="skip-link" href="#main">Skip to content</a>

<header class="site-header" role="banner">
  <!-- keep the checkbox at header root -->
  <input id="nav-open" class="nav-toggle" type="checkbox" aria-hidden="true" />

  <div class="container">
    <div class="nav-shell">
      <!-- Brand -->
      <a href="/" class="brand" aria-label={brand}>
        {logoSrc ? (
          <img
            src={logoSrc}
            alt={brand}
            class="logo"
            width="160"
            height="48"
            fetchpriority="high"
          />
        ) : (
          <span class="brand-text">{brand}</span>
        )}
      </a>

      <!-- Center links -->
      <nav class="nav-links" aria-label="Primary">
        <a href="/" class="link is-active" aria-current="page">Home</a>
        <a href="#aboutus" class="link">About</a>
        <a href="#products" class="link">Products</a>
        <a href="#testimonials" class="link">Testimonials</a>
        <a href="#faq" class="link">FAQ</a>
        <a href="#contact" class="link">Contact</a>
      </nav>

      <!-- Country Selector -->
      <div class="country-selector">
        <button class="country-trigger" aria-expanded="false" aria-haspopup="true" aria-label="Select country">
          <span class="flag-placeholder">üåê</span>
          <span class="country-code">US</span>
          <i class="chev" aria-hidden="true"></i>
        </button>
        <div class="country-dropdown" role="menu" aria-label="Country selection">
          <div class="country-search-container">
            <input 
              type="text" 
              class="country-search" 
              placeholder="Search country..." 
              aria-label="Search countries"
            />
          </div>
          <div class="country-list">
            <!-- Countries will be populated by JavaScript -->
          </div>
        </div>
      </div>

      <!-- CTA -->
      <a class="btn cta" href={ctaHref}>
        <span>{ctaText}</span>
        <i class="chev" aria-hidden="true"></i>
      </a>

      <!-- Enhanced hamburger menu -->
      <label
        for="nav-open"
        class="hamburger"
        role="button"
        tabindex="0"
        aria-haspopup="menu"
        aria-controls="mobile-menu"
        aria-label="Toggle menu"
      >
        <span class="hamburger-box">
          <span class="hamburger-inner"></span>
        </span>
      </label>
    </div>
  </div>

  <!-- Mobile overlay + drawer -->
  <label for="nav-open" class="overlay" aria-hidden="true"></label>
  <div
    class="mobile-drawer"
    id="mobile-menu"
    role="dialog"
    aria-modal="true"
    aria-label="Mobile navigation"
  >
    <nav class="mobile-nav" aria-label="Mobile">
      <div class="mobile-nav-header">
        <span class="mobile-nav-title">Menu</span>
        <label
          for="nav-open"
          class="close-menu"
          role="button"
          aria-label="Close menu"
          aria-controls="mobile-menu"
          tabindex="0"
        >
          <span class="close-menu-icon" aria-hidden="true"></span>
        </label>
      </div>
      <a href="/" class="m-link is-active" aria-current="page">Home</a>
      <a href="#products" class="m-link">Products</a>
      <a href="#testimonials" class="m-link">Testimonials</a>
      <a href="#faq" class="m-link">FAQ</a>
      <a href="#contact" class="m-link">Contact</a>
      
      <!-- Mobile Country Selector -->
      <div class="mobile-country-selector">
        <div class="mobile-country-header">
          <span class="mobile-country-title">Select Country</span>
        </div>
        <div class="mobile-country-list">
          <!-- Mobile countries will be populated by JavaScript -->
        </div>
      </div>
      
      <a href={ctaHref} class="btn m-cta">
        <span>{ctaText}</span><i class="chev" aria-hidden="true"></i>
      </a>
    </nav>
  </div>
</header>

<script is:inline>
  (function () {
    const cb = document.getElementById('nav-open');
    const header = document.querySelector('.site-header');
    const label = document.querySelector('.hamburger');
    const closeLabel = document.querySelector('.close-menu');
    const navLinks = Array.from(
      document.querySelectorAll('.nav-links .link, .mobile-nav .m-link')
    );

    // Order follows actual vertical order on page
    const sectionIds = ['aboutus', 'products', 'testimonials', 'faq', 'contact',];

    // Country selector elements
    const countryTrigger = document.querySelector('.country-trigger');
    const countryDropdown = document.querySelector('.country-dropdown');
    const countryList = document.querySelector('.country-list');
    const mobileCountryList = document.querySelector('.mobile-country-list');
    const countrySearch = document.querySelector('.country-search');
    const flagPlaceholder = document.querySelector('.flag-placeholder');
    const countryCode = document.querySelector('.country-code');

    // Country data
    let countries = [];
    let userCountry = 'US'; // Default

    // Fetch countries from API
    async function fetchCountries() {
      try {
        const response = await fetch('https://test.amrita-fashions.com/api/countries');
        if (!response.ok) throw new Error('Failed to fetch countries');
        countries = await response.json();
        populateCountryLists();
        detectUserCountry();
      } catch (error) {
        console.error('Error fetching countries:', error);
        // Fallback to a few common countries
        countries = [
          { code: 'US', name: 'United States' },
          { code: 'GB', name: 'United Kingdom' },
          { code: 'CA', name: 'Canada' },
          { code: 'AU', name: 'Australia' },
          { code: 'IN', name: 'India' }
        ];
        populateCountryLists();
        detectUserCountry();
      }
    }

    // Populate country lists
    function populateCountryLists() {
      if (!countryList || !mobileCountryList) return;
      
      // Clear existing lists
      countryList.innerHTML = '';
      mobileCountryList.innerHTML = '';
      
      // Sort countries by name
      const sortedCountries = [...countries].sort((a, b) => 
        a.name.localeCompare(b.name)
      );
      
      // Populate desktop dropdown
      sortedCountries.forEach(country => {
        const countryItem = document.createElement('button');
        countryItem.className = 'country-item';
        countryItem.setAttribute('role', 'menuitem');
        countryItem.setAttribute('data-code', country.code);
        countryItem.innerHTML = `
          <span class="country-flag">${getFlagEmoji(country.code)}</span>
          <span class="country-name">${country.name}</span>
        `;
        countryItem.addEventListener('click', () => selectCountry(country.code));
        countryList.appendChild(countryItem);
      });
      
      // Populate mobile list
      sortedCountries.forEach(country => {
        const countryItem = document.createElement('button');
        countryItem.className = 'mobile-country-item';
        countryItem.setAttribute('data-code', country.code);
        countryItem.innerHTML = `
          <span class="country-flag">${getFlagEmoji(country.code)}</span>
          <span class="country-name">${country.name}</span>
        `;
        countryItem.addEventListener('click', () => {
          selectCountry(country.code);
          closeMenu();
        });
        mobileCountryList.appendChild(countryItem);
      });
    }

    // Get flag emoji from country code
    function getFlagEmoji(countryCode) {
      if (!countryCode) return 'üåê';
      const codePoints = countryCode
        .toUpperCase()
        .split('')
        .map(char => 127397 + char.charCodeAt());
      return String.fromCodePoint(...codePoints);
    }

    // Detect user's country
    function detectUserCountry() {
      // Try to get from browser language
      const browserLang = navigator.language || navigator.userLanguage;
      if (browserLang) {
        const langParts = browserLang.split('-');
        if (langParts.length > 1) {
          const detectedCode = langParts[1].toUpperCase();
          if (countries.some(c => c.code === detectedCode)) {
            userCountry = detectedCode;
          }
        }
      }
      
      // Try to get from IP (using a free API)
      fetch('https://ipapi.co/json/')
        .then(response => response.json())
        .then(data => {
          if (data && data.country_code && countries.some(c => c.code === data.country_code)) {
            userCountry = data.country_code;
          }
          updateCountryDisplay();
        })
        .catch(() => {
          updateCountryDisplay();
        });
    }

    // Update country display
    function updateCountryDisplay() {
      if (flagPlaceholder) {
        flagPlaceholder.textContent = getFlagEmoji(userCountry);
      }
      if (countryCode) {
        countryCode.textContent = userCountry;
      }
      
      // Mark selected country in lists
      document.querySelectorAll('.country-item, .mobile-country-item').forEach(item => {
        const code = item.getAttribute('data-code');
        if (code === userCountry) {
          item.classList.add('selected');
        } else {
          item.classList.remove('selected');
        }
      });
    }

    // Select a country
    function selectCountry(code) {
      userCountry = code;
      updateCountryDisplay();
      closeCountryDropdown();
      
      // Store selection
      try {
        localStorage.setItem('selectedCountry', code);
      } catch (e) {
        // Ignore storage errors
      }
    }

    // Toggle country dropdown
    function toggleCountryDropdown() {
      const isExpanded = countryTrigger.getAttribute('aria-expanded') === 'true';
      countryTrigger.setAttribute('aria-expanded', !isExpanded);
      countryDropdown.classList.toggle('open', !isExpanded);
      
      if (!isExpanded) {
        countrySearch.value = '';
        filterCountries();
        countrySearch.focus();
      }
    }

    // Close country dropdown
    function closeCountryDropdown() {
      countryTrigger.setAttribute('aria-expanded', 'false');
      countryDropdown.classList.remove('open');
    }

    // Filter countries based on search
    function filterCountries() {
      const searchTerm = countrySearch.value.toLowerCase();
      const countryItems = countryList.querySelectorAll('.country-item');
      
      countryItems.forEach(item => {
        const countryName = item.querySelector('.country-name').textContent.toLowerCase();
        if (countryName.includes(searchTerm)) {
          item.style.display = 'flex';
        } else {
          item.style.display = 'none';
        }
      });
    }

    // Event listeners for country selector
    if (countryTrigger && countryDropdown) {
      countryTrigger.addEventListener('click', toggleCountryDropdown);
      
      // Close dropdown when clicking outside
      document.addEventListener('click', (e) => {
        if (!countryTrigger.contains(e.target) && !countryDropdown.contains(e.target)) {
          closeCountryDropdown();
        }
      });
      
      // Handle search
      if (countrySearch) {
        countrySearch.addEventListener('input', filterCountries);
      }
      
      // Keyboard navigation
      countryTrigger.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          toggleCountryDropdown();
        } else if (e.key === 'Escape') {
          closeCountryDropdown();
        }
      });
    }

    // Rest of your existing functions
    function syncAria() {
      if (label && cb) {
        label.setAttribute('aria-expanded', cb.checked ? 'true' : 'false');
      }
      if (closeLabel && cb) {
        closeLabel.setAttribute('aria-expanded', cb.checked ? 'true' : 'false');
      }
    }

    function setBodyOffset() {
      const currentVar = parseFloat(
        getComputedStyle(document.documentElement).getPropertyValue('--header-h')
      ) || 96;
      let h = header?.offsetHeight || currentVar;
      if (h < 40) h = currentVar;
      document.documentElement.style.setProperty('--header-h', h + 'px');
      document.body.style.paddingTop = h + 'px';
    }

    function clearActive() {
      navLinks.forEach((link) => {
        link.classList.remove('is-active');
        link.removeAttribute('aria-current');
      });
    }

    function setActiveFor(target) {
      clearActive();

      if (target === 'home') {
        document
          .querySelectorAll('.nav-links .link[href="/"], .mobile-nav .m-link[href="/"]')
          .forEach((link) => {
            link.classList.add('is-active');
            link.setAttribute('aria-current', 'page');
          });
        return;
      }

      const selector = `.nav-links .link[href="#${target}"], .mobile-nav .m-link[href="#${target}"]`;
      const matches = document.querySelectorAll(selector);
      if (matches.length) {
        matches.forEach((link) => {
          link.classList.add('is-active');
          link.setAttribute('aria-current', 'true');
        });
      } else {
        setActiveFor('home');
      }
    }

    function updateActiveLink() {
      const hash = (window.location.hash || '').replace('#', '');
      if (hash && sectionIds.includes(hash)) {
        setActiveFor(hash);
        return;
      }

      const offset = (header?.offsetHeight || 0) + 40;
      const scrollY = (window.scrollY || 0) + offset;

      let active = 'home';
      sectionIds.forEach((id) => {
        const el = document.getElementById(id);
        if (!el) return;
        if (scrollY >= el.offsetTop) {
          active = id;
        }
      });

      setActiveFor(active);
    }

    function onScroll() {
      const y = window.scrollY || 0;
      if (y > 12) header?.classList.add('is-scrolled');
      else header?.classList.remove('is-scrolled');
      updateActiveLink();
    }

    function closeMenu() {
      if (!cb) return;
      cb.checked = false;
      syncAria();
      setTimeout(setBodyOffset, 200);
    }

    document.addEventListener('click', (e) => {
      const target = e.target;
      if (!(target instanceof Element)) return;

      if (
        target.closest('.mobile-nav a') ||
        target.closest('.m-cta') ||
        target.closest('.overlay') ||
        (target.closest('.mobile-drawer') && !target.closest('.mobile-nav')) ||
        target.closest('.close-menu')
      ) {
        closeMenu();
      }

      const navAnchor = target.closest(
  '.nav-links .link, .mobile-nav .m-link, .age-footer .age-navLink'
);

      if (!navAnchor) return;

      const href = navAnchor.getAttribute('href') || '';

      if (href.startsWith('#')) {
        const id = href.slice(1);
        const el = document.getElementById(id);
        if (el) {
          e.preventDefault();
          const offset = (header?.offsetHeight || 0) + 24;
          const top =
            el.getBoundingClientRect().top + window.scrollY - offset;

          window.scrollTo({ top, behavior: 'smooth' });
          setActiveFor(id);
          history.replaceState(null, '', '#' + id);
        }
      }

      if (href === '/') {
        const samePath =
          window.location.pathname === '/' ||
          window.location.pathname === navAnchor.pathname;
        if (samePath) {
          e.preventDefault();
          window.scrollTo({ top: 0, behavior: 'smooth' });
          setActiveFor('home');
          history.replaceState(null, '', '/');
        }
      }
    });

    window.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closeMenu();
        closeCountryDropdown();
      }
    });

    window.addEventListener(
      'resize',
      () => {
        if (window.innerWidth > 1100) closeMenu();
        setBodyOffset();
      },
      { passive: true }
    );

    window.addEventListener('scroll', onScroll, { passive: true });

    setBodyOffset();

    cb && cb.addEventListener('change', () => {
      syncAria();
      setBodyOffset();
    });

    // Ensure the close (X) reliably closes without toggling weirdness
    if (closeLabel) {
      closeLabel.addEventListener('click', (e) => {
        e.preventDefault();
        closeMenu();
      });
    }

    closeLabel &&
      closeLabel.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          closeMenu();
        }
      });

    window.addEventListener(
      'load',
      () => {
        if ('scrollRestoration' in history) history.scrollRestoration = 'manual';
        // Avoid landing on a deep hash after refresh; always start at top
        history.replaceState(null, '', '/');
        window.scrollTo(0, 0);

        syncAria();
        setBodyOffset();
        onScroll();
        setActiveFor('home');
        
        // Initialize country selector
        fetchCountries();
        
        // Check for stored country preference
        try {
          const storedCountry = localStorage.getItem('selectedCountry');
          if (storedCountry && countries.some(c => c.code === storedCountry)) {
            userCountry = storedCountry;
            updateCountryDisplay();
          }
        } catch (e) {
          // Ignore storage errors
        }
      },
      { once: true }
    );

    if ('ResizeObserver' in window && header) {
      new ResizeObserver(setBodyOffset).observe(header);
    }
  })();
</script>

<style>
:root{
  --header-h: 96px;
}
body{
  padding-top: var(--header-h);
}

/* ---------- a11y ---------- */
.skip-link{
  position: absolute;
  left: -10000px;
  top: auto;
  width: 1px;
  height: 1px;
  overflow: hidden;
  background: var(--tp-common-white);
  color: var(--tp-text-1);
  font-weight: 600;
  padding: 12px 16px;
  border-radius: 8px;
  z-index: 2000;
  box-shadow: 0 6px 18px rgba(0,0,0,.12);
  transition: opacity 0.2s ease;
}
.skip-link:focus{
  left: 16px;
  top: 16px;
  width: auto;
  height: auto;
  opacity: 1;
}

/* ---------- header container (fixed) ---------- */
.site-header{
  --nav-bg:     var(--tp-nav-bg, rgba(255,255,255,.86));
  --nav-border: var(--tp-nav-border, rgba(17,35,56,.10));
  --nav-shadow: var(--tp-nav-shadow, 0 10px 30px rgba(17,35,56,.10));
  --nav-pad-y:  var(--tp-nav-pad-y, 12px);
  --nav-pad-x:  var(--tp-nav-pad-x, 16px);

  --brand: var(--tp-theme-primary,#2C4C97);
  --gold:  var(--tp-theme-secondary,#D6A74B);
  --ink:        var(--tp-text-1,#0F2235);
  --ink-dim:    rgba(15,34,53,.72);

  position: fixed;
  left: 0;
  right: 0;
  top: 0; /* pinned at very top */
  z-index: 900;
  background: transparent;
  padding-block: clamp(6px, 1.2vw, 12px);
  transition: padding .25s ease, background .25s ease, box-shadow .3s ease;
}
.site-header.is-scrolled{
  background: rgba(255,255,255,.96);
  box-shadow: 0 1px 0 rgba(12,28,52,.08);
  backdrop-filter: blur(12px);
}

/* ---------- pill shell ---------- */
.nav-shell{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: clamp(16px, 2vw, 32px);
  width: 100%;
  padding: var(--nav-pad-y) var(--nav-pad-x);
  background: var(--nav-bg);
  border: 1px solid var(--nav-border);
  border-radius: 9999px;
  box-shadow: var(--nav-shadow);
  -webkit-backdrop-filter: saturate(140%) blur(10px);
  backdrop-filter: saturate(140%) blur(10px);
  transition: all 0.3s ease;
  min-width: 0;
}
.site-header.is-scrolled .nav-shell{
  background: transparent;
  border: none;
  box-shadow: none;
  border-radius: 0;
}

/* Brand */
.brand{
  display:flex;
  align-items:center;
  gap:10px;
  min-height:44px;
  padding-inline:6px;
  transition:transform .2s ease;
  flex: 0 0 auto;
}
.brand:hover { transform: translateY(-1px); }

/* Logo: explicit, responsive sizes */
.logo{
  display:block;
  width:auto;
  height:48px;
  max-height:48px;
  border-radius:12px;
  transition: all .3s ease;
}
.brand-text{
  font: 800 18px/1 var(--tp-ff-display, system-ui);
  letter-spacing:.2px;
  color:var(--ink);
  transition:color .2s ease;
}

/* Links */
.nav-links{
  display:flex;
  align-items:center;
  justify-content:center;
  gap: clamp(16px, 2.4vw, 36px);
  flex: 1 1 auto;
  min-width: 0;
  margin-inline: clamp(12px, 4vw, 56px);
}
.link{
  position: relative;
  display:inline-flex;
  align-items:center;
  color: var(--ink-dim);
  font-weight: 600;
  letter-spacing: .08px;
  padding: 10px 16px;
  border-radius: 10px;
  line-height:1;
  transition: all .25s cubic-bezier(.25,.46,.45,.94);
  outline: none;
  font-size: 15px;
}
.link::after{
  content:"";
  position:absolute;
  left:16px;
  right:16px;
  bottom:6px;
  height:2px;
  border-radius:1px;
  background: transparent;
  transform: scaleX(0);
  transform-origin:center;
  transition: transform .25s ease, background .25s ease;
}
.link:hover{
  color:var(--brand);
  transform: translateY(-1px);
}
.link:hover::after{
  background:var(--brand);
  transform: scaleX(1);
}
.link.is-active{
  color:var(--brand);
  font-weight:700;
}
.link.is-active::after{
  background:var(--brand);
  transform: scaleX(1);
}
.link:focus-visible{
  box-shadow: 0 0 0 2px rgba(44,76,151,.15);
  background: rgba(44,76,151,.05);
}

/* Country Selector */
.country-selector {
  position: relative;
  margin-right: 12px;
}

.country-trigger {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background: transparent;
  border: 1px solid rgba(17,35,56,.12);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 14px;
  font-weight: 600;
  color: var(--ink);
}

.country-trigger:hover {
  background: rgba(44,76,151,.05);
  border-color: rgba(44,76,151,.3);
}

.country-trigger:focus-visible {
  outline: none;
  box-shadow: 0 0 0 2px rgba(44,76,151,.2);
}

.flag-placeholder {
  font-size: 18px;
}

.country-code {
  font-weight: 700;
}

.country-trigger .chev {
  width: 6px;
  height: 6px;
  border-right: 2px solid currentColor;
  border-bottom: 2px solid currentColor;
  transform: rotate(45deg);
  transition: transform 0.2s ease;
}

.country-trigger[aria-expanded="true"] .chev {
  transform: rotate(-135deg);
}

.country-dropdown {
  position: absolute;
  top: 100%;
  right: 0;
  margin-top: 8px;
  width: 280px;
  background: var(--nav-bg);
  border: 1px solid var(--nav-border);
  border-radius: 12px;
  box-shadow: 0 10px 30px rgba(17,35,56,.15);
  opacity: 0;
  visibility: hidden;
  transform: translateY(-10px);
  transition: all 0.3s ease;
  z-index: 1000;
  backdrop-filter: saturate(140%) blur(10px);
  -webkit-backdrop-filter: saturate(140%) blur(10px);
}

.country-dropdown.open {
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
}

.country-search-container {
  padding: 12px;
  border-bottom: 1px solid rgba(17,35,56,.08);
}

.country-search {
  width: 100%;
  padding: 8px 12px;
  border: 1px solid rgba(17,35,56,.12);
  border-radius: 6px;
  font-size: 14px;
  transition: border-color 0.2s ease;
}

.country-search:focus {
  outline: none;
  border-color: var(--brand);
  box-shadow: 0 0 0 2px rgba(44,76,151,.1);
}

.country-list {
  max-height: 300px;
  overflow-y: auto;
  padding: 8px 0;
}

.country-item {
  display: flex;
  align-items: center;
  gap: 12px;
  width: 100%;
  padding: 10px 16px;
  background: transparent;
  border: none;
  cursor: pointer;
  transition: background 0.2s ease;
  font-size: 14px;
  text-align: left;
}

.country-item:hover {
  background: rgba(44,76,151,.08);
}

.country-item.selected {
  background: rgba(44,76,151,.12);
  font-weight: 600;
  color: var(--brand);
}

.country-flag {
  font-size: 16px;
  width: 20px;
  text-align: center;
}

.country-name {
  flex: 1;
}

/* Mobile Country Selector */
.mobile-country-selector {
  margin: 16px 0 8px;
  border-top: 1px solid rgba(17,35,56,.08);
  padding-top: 16px;
}

.mobile-country-header {
  margin-bottom: 12px;
}

.mobile-country-title {
  font-size: 14px;
  font-weight: 600;
  color: var(--ink-dim);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.mobile-country-list {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 8px;
  max-height: 200px;
  overflow-y: auto;
}

.mobile-country-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 12px;
  background: transparent;
  border: 1px solid rgba(17,35,56,.08);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 13px;
}

.mobile-country-item:hover {
  background: rgba(44,76,151,.08);
  border-color: rgba(44,76,151,.2);
}

.mobile-country-item.selected {
  background: rgba(44,76,151,.12);
  border-color: var(--brand);
  font-weight: 600;
  color: var(--brand);
}

/* CTA */
.btn{
  display:inline-flex;
  align-items:center;
  gap:10px;
  font-weight:700;
  padding:12px 20px;
  border-radius:12px;
  text-decoration:none;
  line-height:1;
  transition: all .3s cubic-bezier(.25,.46,.45,.94);
  position:relative;
  overflow:hidden;
  font-size:15px;
}
.btn::before{
  content:"";
  position:absolute;
  top:0;
  left:-100%;
  width:100%;
  height:100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,.3), transparent);
  transition:left .5s ease;
}
.btn:hover::before{ left:100%; }
.btn.cta{
  background: linear-gradient(135deg, var(--gold), #eac271);
  color: var(--tp-common-black,#0F2235);
  box-shadow: 0 6px 16px rgba(214,167,75,.2), 0 1px 0 rgba(255,255,255,.45) inset;
  margin-left: clamp(12px, 2vw, 28px);
  flex: 0 0 auto;
}
.btn.cta:hover{
  transform: translateY(-2px);
  box-shadow: 0 10px 20px rgba(214,167,75,.3), 0 1px 0 rgba(255,255,255,.45) inset;
}
.btn .chev{
  width:8px;
  height:8px;
  border-right:2px solid currentColor;
  border-bottom:2px solid currentColor;
  transform: rotate(-45deg);
  margin-top:1px;
  transition: transform .2s ease;
}
.btn:hover .chev{ transform: rotate(-45deg) translateX(2px); }

/* Hamburger */
.nav-toggle{ display:none; }
.hamburger{
  display:none;
  position:relative;
  width:44px;
  height:44px;
  border-radius:50%;
  cursor:pointer;
  padding:0;
  border:none;
  background:transparent;
  transition: all .3s ease;
}
.hamburger-box{
  width:22px;
  height:16px;
  display:inline-block;
  position:relative;
}
.hamburger-inner{ display:block; top:50%; margin-top:-1px; }
.hamburger-inner,
.hamburger-inner::before,
.hamburger-inner::after{
  width:22px;
  height:2px;
  background-color: var(--ink);
  border-radius:2px;
  position:absolute;
  transition: transform .3s ease, background-color .3s ease, opacity .3s ease;
}
.hamburger-inner::before,
.hamburger-inner::after{
  content:"";
  display:block;
}
.hamburger-inner::before{ top:-6px; }
.hamburger-inner::after{ bottom:-6px; }
.hamburger:hover{
  background: rgba(44,76,151,.06);
}
.hamburger:hover .hamburger-inner,
.hamburger:hover .hamburger-inner::before,
.hamburger:hover .hamburger-inner::after{
  background-color: var(--brand);
}

/* morph to X */
#nav-open:checked + .container .nav-shell .hamburger .hamburger-inner{
  transform: rotate(45deg);
}
#nav-open:checked + .container .nav-shell .hamburger .hamburger-inner::before{
  top:0;
  transform: rotate(-90deg);
}
#nav-open:checked + .container .nav-shell .hamburger .hamburger-inner::after{
  bottom:0;
  opacity:0;
}

/* Drawer & overlay */
.overlay{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.35);
  opacity: 0;
  pointer-events: none;
  transition: opacity .3s ease;
  z-index: 1000;
}
.mobile-drawer{
  position: fixed;
  inset: 0;
  padding-top: max(12px, env(safe-area-inset-top));
  background: transparent;
  pointer-events: none;
  display:grid;
  place-items:start;
  z-index: 1100;
}
.mobile-nav{
  width: min(500px, 92vw);
  margin: 12px auto;
  border-radius: 20px;
  background: rgba(255,255,255,.98);
  -webkit-backdrop-filter: saturate(140%) blur(12px);
  backdrop-filter: saturate(140%) blur(12px);
  border: 1px solid var(--nav-border);
  box-shadow: 0 20px 50px rgba(17,35,56,.15);
  transform: translateY(-12px);
  opacity: 0;
  transition: all .3s cubic-bezier(.25,.46,.45,.94);
  padding: 20px var(--page-xpad, 16px) 24px;
  display:flex;
  flex-direction:column;
  gap:6px;
}
.mobile-nav-header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding-bottom:6px;
  margin-bottom:6px;
  border-bottom:1px solid rgba(17,35,56,.08);
}
.mobile-nav-title{
  font-size:16px;
  font-weight:700;
  color:var(--ink);
}
.close-menu{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width:36px;
  height:36px;
  border-radius:50%;
  cursor:pointer;
  border:none;
  background:rgba(44,76,151,.08);
  transition:background .2s ease, transform .2s ease;
}
.close-menu:hover,
.close-menu:focus-visible{
  background:rgba(44,76,151,.14);
  outline:none;
  transform:translateY(-1px);
}
.close-menu-icon{
  position:relative;
  width:16px;
  height:16px;
  display:block;
}
.close-menu-icon::before,
.close-menu-icon::after{
  content:"";
  position:absolute;
  inset:0;
  margin:auto;
  width:16px;
  height:2px;
  border-radius:2px;
  background:var(--ink);
  transition:background .3s ease;
}
.close-menu-icon::before{ transform:rotate(45deg); }
.close-menu-icon::after{ transform:rotate(-45deg); }
.m-link{
  display:block;
  padding:14px 18px;
  border-radius:10px;
  font-weight:600;
  color: var(--ink);
  text-decoration:none;
  background:transparent;
  transition: all .25s ease;
  position:relative;
  overflow:hidden;
  font-size:16px;
}
.m-link::before{
  content:"";
  position:absolute;
  top:0;
  left:0;
  width:3px;
  height:100%;
  background: var(--brand);
  transform: scaleY(0);
  transform-origin: bottom;
  transition: transform .25s ease;
}
.m-link:hover{
  background: rgba(44,76,151,.08);
  color: var(--brand);
  padding-left:22px;
}
.m-link:hover::before{ transform: scaleY(1); }
.m-link.is-active{
  background: rgba(44,76,151,.12);
  color: var(--brand);
  font-weight:700;
  padding-left:22px;
}
.m-link.is-active::before{ transform: scaleY(1); }
.btn.m-cta{
  margin-top:12px;
  background: linear-gradient(135deg, var(--gold), #eac271);
  color:#0F2235;
  justify-content:center;
  box-shadow: 0 6px 16px rgba(214,167,75,.2);
  font-weight:700;
}
.btn.m-cta:hover{
  transform: translateY(-2px);
  box-shadow: 0 10px 20px rgba(214,167,75,.3);
}

/* open states & body lock */
#nav-open:checked ~ .overlay{
  opacity: 1;
  pointer-events: auto;
}
#nav-open:checked ~ .mobile-drawer{
  pointer-events: auto;
}
#nav-open:checked ~ .mobile-drawer .mobile-nav{
  transform: translateY(0);
  opacity: 1;
}
body:has(#nav-open:checked){
  overflow: hidden;
}

/* ---------- breakpoints ---------- */
@media (max-width: 1100px){
  .nav-links{ display:none; }
  .btn.cta{ display:none; }
  .hamburger{
    display:flex;
    align-items:center;
    justify-content:center;
    margin-left:auto;
  }
  .logo{
    height:42px;
    max-height:42px;
  }
  .nav-shell{
    justify-content: space-between;
    gap:12px;
  }
}
@media (max-width: 768px){
  .nav-shell{
    gap:10px;
    padding:10px 12px;
  }
  .logo{
    height:38px;
    max-height:38px;
  }
  .hamburger{
    width:42px;
    height:42px;
  }
  .mobile-nav{
    border-radius:18px;
    padding:18px var(--page-xpad, 16px) 22px;
  }
}
@media (max-width: 640px){
  .logo{
    height:34px;
    max-height:34px;
  }
  .hamburger{
    width:40px;
    height:40px;
  }
  .hamburger-box{
    width:20px;
    height:14px;
  }
  .hamburger-inner,
  .hamburger-inner::before,
  .hamburger-inner::after{
    width:20px;
  }
  .mobile-nav{
    border-radius:16px;
    padding:16px var(--page-xpad, 16px) 20px;
  }
  .m-link{
    padding:12px 16px;
    font-size:15px;
  }
}
@media (max-width: 420px){
  .nav-shell{ border-radius:20px; }
  .logo{
    height:30px;
    max-height:30px;
  }
  .hamburger{
    width:38px;
    height:38px;
  }
  .mobile-nav{
    border-radius:14px;
    padding:14px var(--page-xpad, 16px) 18px;
  }
}

/* ---------- dark theme ---------- */
.theme-dark .site-header{
  --nav-bg:     rgba(15,27,45,.88);
  --nav-border: rgba(255,255,255,.12);
  --nav-shadow: 0 16px 40px rgba(0,0,0,.4);
  --ink:        var(--tp-common-black,#e7edf6);
  --ink-dim:    rgba(231,237,246,.75);
}
.theme-dark .btn.cta{ color:#0f1b2d; }
.theme-dark .hamburger .hamburger-inner,
.theme-dark .hamburger .hamburger-inner::before,
.theme-dark .hamburger .hamburger-inner::after{
  background-color: var(--tp-common-black);
}
.theme-dark .hamburger:hover .hamburger-inner,
.theme-dark .hamburger:hover .hamburger-inner::before,
.theme-dark .hamburger:hover .hamburger-inner::after{
  background-color: var(--tp-theme-secondary);
}
.theme-dark .mobile-nav{
  background: rgba(15,27,45,.95);
  border-color: rgba(255,255,255,.15);
}
.theme-dark .mobile-nav-header{
  border-color: rgba(255,255,255,.12);
}
.theme-dark .mobile-nav-title{
  color: var(--tp-common-black,#e7edf6);
}
.theme-dark .close-menu{
  background: rgba(44,76,151,.16);
}
.theme-dark .close-menu:hover,
.theme-dark .close-menu:focus-visible{
  background: rgba(44,76,151,.22);
}
.theme-dark .close-menu-icon::before,
.theme-dark .close-menu-icon::after{
  background: var(--tp-common-black,#e7edf6);
}
.theme-dark .m-link:hover{
  background: rgba(44,76,151,.2);
}
.theme-dark .link:focus-visible{
  box-shadow: 0 0 0 2px rgba(44,76,151,.3);
  background: rgba(44,76,151,.1);
}
</style>
